{"version":3,"file":"index.cjs.js","sources":["../lib/PaymentWidget.js"],"sourcesContent":["/**\n * Creates an instance of ChimoneyWidget.\n *\n * @class ChimoneyWidget\n * @param {Object} options - Configuration options for the widget.\n * @param {string} options.paymentLink - The URL to the Chimoney payment page, required for initializing the widget. This must be a valid URL.\n * @param {string} [options.brandColor='#000'] - Customize the primary color of the payment widget to match your brand theme. Default is black.\n * @param {string} [options.brandName='Chimoney'] - Your brand's name, which will be displayed on the widget to enhance trust. Default is 'Chimoney'.\n * @param {boolean} [options.backgroundColor=\"#ffffff\"] - The background color.\n *\n * @throws {Error} Throws an error if the paymentLink is not provided or is invalid.\n *\n * @example\n * const chimoneyPay = new ChimoneyWidget({\n *   paymentLink: 'https://dash.chimoney.io/pay?issueID=your_unique_issue_id',\n *   brandColor: '#FF5722',\n *   brandName: 'Your Brand'\n * });\n */\n\nclass ChimoneyWidget {\n  /**\n   * Constructs the ChimoneyWidget with user-provided options.\n   * Validates the mandatory `paymentLink` parameter.\n   * Initializes modal and iframe components.\n   *\n   * @param {Object} options - Configuration options for the widget.\n   * @param {string} options.paymentLink - The URL to the Chimoney payment page.\n   * @param {string} [options.brandColor='#000'] - Primary color of the widget, default is black.\n   * @param {string} [options.brandName='Chimoney'] - Name of the brand, default is 'Chimoney'.\n   * @param {boolean} [options.turnOffNotification=false] - If true, disables notifications from Chimoney.\n   * @param {Object} [options.meta] - Metadata for tracking or additional purposes.\n   * @param {boolean} [options.backgroundColor=\"#ffffff\"] - The background color.\n   * @throws {Error} If `paymentLink` is not provided or invalid.\n   */\n  constructor (options = {}) {\n    this.validateOptions(options);\n    this.options = options;\n    this.modal = null;\n    this.iframe = null;\n    this.createModal();\n  }\n\n  /**\n   * Validates the options object, particularly the `paymentLink`.\n   * @param {Object} options - The options provided to the constructor.\n   * @throws {Error} If the `paymentLink` is missing or invalid.\n   */\n  validateOptions (options) {\n    if (!options.paymentLink || !this.isValidUrl(options.paymentLink)) {\n      throw new Error('Invalid or missing paymentLink.');\n    }\n  }\n\n  /**\n   * Checks if a URL is valid.\n   * @param {string} url - The URL to validate.\n   * @returns {boolean} True if the URL is valid, false otherwise.\n   */\n  isValidUrl (url) {\n    try {\n      URL(url);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  /**\n   * Creates and appends the modal element to the DOM.\n   * The modal serves as a container for the iframe.\n   */\n  createModal () {\n    const modalHTML = `\n            <div id=\"chimoneyModal\" style=\"display:none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.4);\">\n                <div style=\"background-color: #fefefe; margin: 15% auto; padding: 20px; border: 1px solid #888; width: 80%; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);\">\n                    <span id=\"closeModal\" style=\"color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer;\">&times;</span>\n                    <iframe id=\"chimoneyPaymentFrame\" style=\"width:100%; height:500px; border:none; border-radius: 5px;\"></iframe>\n                </div>\n            </div>\n        `;\n    document.body.insertAdjacentHTML('beforeend', modalHTML);\n    this.modal = document.getElementById('chimoneyModal');\n    this.iframe = document.getElementById('chimoneyPaymentFrame');\n    document\n      .getElementById('closeModal')\n      .addEventListener('click', () => this.close());\n  }\n\n  /**\n   * Opens the modal containing the iframe.\n   * This method makes the modal visible, showing the payment interface.\n   */\n  open (paymentLink) {\n    this.applyBranding(); // Apply branding styles if any\n    this.iframe.style.width = '100%';\n    this.iframe.style.height = '100%';\n    this.iframe.src = this.appendCustomizations(paymentLink);\n    this.modal.style.display = 'block';\n  }\n\n  /**\n   * Closes the modal containing the iframe.\n   * This method hides the modal, effectively closing the payment interface.\n   */\n  close () {\n    this.modal.style.display = 'none';\n  }\n\n  applyBranding () {\n    if (this.options.brandColor) {\n      this.modal.querySelector('div').style.borderColor =\n        this.options.brandColor;\n    }\n    if (this.options.modalBackground) {\n      this.modal.style.backgroundColor = this.options.modalBackground;\n    }\n  }\n\n  appendCustomizations (url) {\n    // Assuming the Chimoney API can handle URL parameters for customization\n    const urlParams = new URLSearchParams(this.options).toString();\n    return `${url}?${urlParams}`;\n  }\n}\n\nexport default ChimoneyWidget;\n"],"names":["_typeof","o","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","_toPropertyKey","key","_createClass","protoProps","staticProps","t","_toPrimitive","r","e","toPrimitive","call","String","Number","ChimoneyWidget","options","arguments","undefined","validateOptions","modal","iframe","createModal","value","paymentLink","isValidUrl","Error","url","URL","_this","modalHTML","document","body","insertAdjacentHTML","getElementById","addEventListener","close","open","applyBranding","style","width","height","src","appendCustomizations","display","brandColor","querySelector","borderColor","modalBackground","backgroundColor","urlParams","URLSearchParams","toString","concat"],"mappings":"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"}