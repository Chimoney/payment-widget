{"version":3,"file":"index.js","sources":["../lib/PaymentWidget.js"],"sourcesContent":["/**\n * Creates an instance of ChimoneyWidget.\n *\n * @class ChimoneyWidget\n * @param {Object} options - Configuration options for the widget.\n * @param {string} options.paymentLink - The URL to the Chimoney payment page, required for initializing the widget. This must be a valid URL.\n * @param {string} [options.brandColor='#000'] - Customize the primary color of the payment widget to match your brand theme. Default is black.\n * @param {string} [options.brandName='Chimoney'] - Your brand's name, which will be displayed on the widget to enhance trust. Default is 'Chimoney'.\n *\n * @throws {Error} Throws an error if the paymentLink is not provided or is invalid.\n *\n * @example\n * const chimoneyPay = new ChimoneyWidget({\n *   paymentLink: 'https://dash.chimoney.io/pay?issueID=your_unique_issue_id',\n *   brandColor: '#FF5722',\n *   brandName: 'Your Brand'\n * });\n */\n\nclass ChimoneyWidget {\n  /**\n   * Constructs the ChimoneyWidget with user-provided options.\n   * Validates the mandatory `paymentLink` parameter.\n   * Initializes modal and iframe components.\n   *\n   * @param {Object} options - Configuration options for the widget.\n   * @param {string} options.paymentLink - The URL to the Chimoney payment page.\n   * @param {string} [options.brandColor='#000'] - Primary color of the widget, default is black.\n   * @param {string} [options.brandName='Chimoney'] - Name of the brand, default is 'Chimoney'.\n   * @throws {Error} If `paymentLink` is not provided or invalid.\n   */\n  constructor(options = {}) {\n    this.validateOptions(options);\n    this.options = options;\n    this.modal = null;\n    this.iframe = null;\n    this.loadingIndicator = null;\n    this.createModal();\n  }\n\n  /**\n   * Validates the options object, particularly the `paymentLink`.\n   * @param {Object} options - The options provided to the constructor.\n   * @throws {Error} If the `paymentLink` is missing or invalid.\n   */\n  validateOptions(options) {\n    if (!options.paymentLink || !this.isValidUrl(options.paymentLink)) {\n      throw new Error(\"Invalid or missing paymentLink.\");\n    }\n  }\n\n  /**\n   * Checks if a URL is valid.\n   * @param {string} url - The URL to validate.\n   * @returns {boolean} True if the URL is valid, false otherwise.\n   */\n  isValidUrl(url) {\n    try {\n      url = new URL(url);\n      return url;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  /**\n   * Creates and appends the modal element to the DOM.\n   * The modal serves as a container for the iframe.\n   */\n  createModal() {\n    const modalHTML = `\n            <div id=\"chimoneyModal\" style=\"display:none; position: fixed; z-index: 10000; left: 0; top: 0; width: 100%; min-height:70vh; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.8);\">\n                <div style=\"background-color: #ffffff; margin: 2% auto; padding: 0px; padding-bottom: 0px; border: 1px solid #dddddd; width: 90%; height: 90%; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width:550px;\">\n                    <span id=\"closeModal\" style=\"color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer;padding-right: 10px;\">&times;</span>\n                    <iframe id=\"chimoneyPaymentFrame\" style=\"width:100%; min-height:500px; border:none; border-radius: 5px; z-index: 1000\"></iframe>\n                    <div id=\"loadingIndicator\" style=\"position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); display: block;\">\n                      <img src=\"https://imagedelivery.net/FWOxhF6qUOoRrmL6RllgbQ/519deb7a-a00a-4d41-24ce-9c46d17f7f00/public\" alt=\"Loading...\" style=\"width: 270px; height: 180px;\">\n                    </div>\n                </div>\n            </div>\n        `;\n    document.body.insertAdjacentHTML(\"beforeend\", modalHTML);\n    this.modal = document.getElementById(\"chimoneyModal\");\n    this.modal.style.minHeight = \"80vh\";\n    this.iframe = document.getElementById(\"chimoneyPaymentFrame\");\n    this.loadingIndicator = document.getElementById(\"loadingIndicator\");\n    document\n      .getElementById(\"closeModal\")\n      .addEventListener(\"click\", () => this.close());\n\n    // Show loading indicator until the iframe is fully loaded\n    this.iframe.addEventListener(\"load\", () => {\n      this.loadingIndicator.style.display = \"none\";\n    });\n  }\n\n  /**\n   * Opens the modal containing the iframe.\n   * This method makes the modal visible, showing the payment interface.\n   */\n  open() {\n    this.applyBranding();\n    this.iframe.style.width = \"100%\";\n    this.iframe.style.height = \"90%\";\n    this.iframe.src = this.appendCustomizations(this.options.paymentLink);\n    this.modal.style.display = \"block\";\n    this.loadingIndicator.style.display = \"block\"; // Show loading indicator\n  }\n\n  /**\n   * Closes the modal containing the iframe.\n   * This method hides the modal, effectively closing the payment interface.\n   */\n  close() {\n    this.modal.style.display = \"none\";\n  }\n\n  applyBranding() {\n    if (this.options.brandColor) {\n      this.modal.querySelector(\"div\").style.borderColor =\n        this.options.brandColor;\n    }\n  }\n\n  appendCustomizations(url) {\n    // Assuming the Chimoney API can handle URL parameters for customization\n    const urlParams = decodeURIComponent(\n      new URLSearchParams(this.options).toString()\n    );\n    return `${url}&${urlParams}`;\n  }\n}\n\nexport default ChimoneyWidget;\n"],"names":[],"mappings":"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"}